fixed the v2 logic with changes 
